
{% extends 'LVR/user/base.html' %}
{% load static %}
{% load i18n %} 
{% load crispy_forms_tags %} 


{% block dashboard %}


<div class="container-fluid">

    <h1 class="mt-4"> {% trans 'dashboard_mainTitle_dashboard' %} </h1>
    <ol class="breadcrumb mb-4">
        <li class="breadcrumb-item active"> {% trans 'dashboard_mainTitle_dashboard' %} </li>
    </ol>
    <div class="row mb-4">

        {% if request.user.is_superuser %}
        <div class="col-xl-3 col-md-6 py-1 pb-3">
            <div class="card border-2 categories-item shadow-sm border-secondary-light bg-gray-200">
              <div class="card-body px-4 py-4">
                  <div class="d-flex d-inline justify-content-center text-shadow-light">
                      <i class="material-icons mr-2 text-primary">person_add_alt_1</i> 
                      <h2 class="h5"> <a class="stretched-link reset-anchor-inherit" href="{% url 'signup' %}"> {% trans 'AddUserAuthor' %}</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 py-1 pb-3">
            <div class="card border-1 categories-item shadow-sm border-secondary-light bg-gray-200">
              <div class="card-body px-4 py-4">
                  <div class="d-flex d-inline justify-content-center text-shadow-light">
                      <i class="material-icons mr-2 text-primary">fact_check</i> 
                      <h2 class="h5"> <a class="stretched-link reset-anchor-inherit" href="{% url 'moderate' %}"> {% trans 'ModeratePosts' %}</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 py-1 pb-3">
            <div class="card border-1 categories-item shadow-sm border-secondary-light bg-gray-200">
              <div class="card-body px-4 py-4">
                  <div class="d-flex d-inline justify-content-center text-shadow-light">
                      <i class="material-icons mr-2 text-primary">event</i> 
                      <h2 class="h5"> <a class="stretched-link reset-anchor-inherit" href=""> {% trans 'AddNewEvent' %}</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 py-1 pb-3">
            <div class="card border-1 categories-item shadow-sm border-secondary-light bg-gray-200">
              <div class="card-body px-4 py-4">
                  <div class="d-flex d-inline justify-content-center text-shadow-light">
                      <i class="material-icons mr-2 text-primary">category</i> 
                      <h2 class="h5"> <a class="stretched-link reset-anchor-inherit" href="{% url 'new_category' %}"> {% trans 'AddNewCategory' %}</a></h2>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <div class="col-xl-3 col-md-6 py-1 pb-3">
            <div class="card border-1 categories-item shadow-sm border-secondary-light">
              <div class="card-body px-4 py-4">
                  <div class="d-flex d-inline justify-content-center text-shadow-light">
                      <i class="material-icons mr-2 text-primary">add_box</i> 
                      <h2 class="h5"> <a class="stretched-link reset-anchor-inherit" href="{% url 'post_new' %}">{% trans 'NewPost' %}</a></h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 py-1 pb-3">
            <div class="card border-1 categories-item shadow-sm border-secondary-light">
              <div class="card-body px-4 py-4">
                  <div class="d-flex d-inline justify-content-center text-shadow-light">
                      <i class="material-icons mr-2 text-primary">notifications</i> 
                      <h2 class="h5"> <a class="stretched-link reset-anchor-inherit" href="{% url 'notifications' %}"> {% trans 'dashboard_Notifications' %} </a></h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 py-1 pb-3">
            <div class="card border-1 categories-item shadow-sm border-secondary-light">
              <div class="card-body px-4 py-4">
                  <div class="d-flex d-inline justify-content-center text-shadow-light">
                      <i class="material-icons mr-2 text-primary">date_range</i> 
                      <h2 class="h5"> <a class="stretched-link reset-anchor-inherit" href="{% url 'calendar' %}"> {% trans 'Calendar' %} </a></h2>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 py-1 pb-3">
            <div class="card border-1 categories-item shadow-sm border-secondary-light">
              <div class="card-body px-4 py-4">
                  <div class="d-flex d-inline justify-content-center text-shadow-light">
                      <i class="material-icons mr-2 text-primary">person</i> 
                      <h2 class="h5"> <a class="stretched-link reset-anchor-inherit" href="{% url 'profile' %}">  {% trans 'dashboard_DropDown_Profile' %} </a></h2>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="card mb-4">
        <div class="card-header">
            <div class="row d-flex d-inline justify-content-between mx-1">
                <span class="d-flex d-inline">
                    <i class="material-icons align-top mr-2">view_compact</i> 
                    <h6> {% trans 'dashboard_table_MyLatestPosts' %} </h6>
                </span>

                <a href="{% url 'post_list' %}" class="h6"> {% trans 'dashboard_table_AllMyPosts' %} </a>
            </div>
        </div> 

        <div class="card-body">

           
               
          
            <div class="table-responsive">
                <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                    <thead class="bg-dark text-white">
                        <tr>
                            <th> {% trans 'dashboard_tableTitle_PostDetail' %} </th>
                            <th> {% trans 'dashboard_tableTitle_PostTitle' %} </th>
                            <th> {% trans 'dashboard_tableTitle_PostSubtitle' %} </th>
                            <th> {% trans 'dashboard_tableTitle_PostImage' %} </th>
                            <th> {% trans 'dashboard_tableTitle_PostPublishedDate' %} </th>
                            <th> {% trans 'dashboard_tableTitle_PostComments' %} </th>
                            <th> {% trans 'dashboard_tableTitle_PostApproved' %} </th>
                            <th> {% trans 'dashboard_tableTitle_PostActions' %} </th>
                        </tr>
                    </thead>
                    <!-- <tfoot>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Age</th>
                            <th>Start date</th>
                            <th>Salary</th>
                        </tr>
                    </tfoot> -->
                    <tbody>
                        {% for post in posts_by_author %}
                        
                        <tr>
                            <td class="text-center"> <a href="{% url 'post_detail' post.category post.slug %}" target="_blank"> <i class="material-icons align-top md-inactive">open_in_new</i> </a> </td>
                            
                            <td style="max-width: 350px;"> {{ post.title }} </td>
                            <td> {{ post.subtitle }} </td>
                           
                            <td class="text-center"> 
                                <div data-toggle="tooltip" data-html="true" data-placement='bottom' title="{{ post.image.url}}">
                                    <a href="{{ post.image.url }}" target="_blank"> <i class="material-icons align-top md-inactive">image</i> </a> 
                               </div>
                            </td>

                            <td> {{ post.published_date }} </td>
                            
                            <td>
                                {% if post.all_cmts %}
                                <span class="d-flex d-inline justify-content-left"> <h6 class="font-weight-bold mr-1"> {{ post.all_cmts }} </h6> 
                                    {% trans 'dashboard_table_TotalComments' %} </span>
                                    <hr class=" mt-0 mb-2" style="margin:0px; max-width: 70px;"> 
                                    {% trans 'dashboard_table_ApprovedComments' %}: {{ post.approved_cmts }} <br>
                                    {% trans 'dashboard_table_RejectedComments' %}: {{ post.non_approved_cmts }}
                                </span>
                                {% else %}
                                <p> {% trans 'NoComments' %} </p>
                                {% endif %}
                            </td>
                           
                           
                            <td class="text-center"> 

                                {% if post.status == 0 %}
                                <div class="" data-toggle="tooltip" data-html="true" data-placement='bottom' title="{% trans 'status_draft_desc' %}">
                                    <i class="px-0 material-icons align-top md-inactive">access_time</i>  
                                </div>
                                {% endif %}

                                {% if post.status == 1 %}
                                <div class="" data-toggle="tooltip" data-html="true" data-placement='bottom' title="{% trans 'status_approved_desc' %}">
                                    <i class="px-0 material-icons align-top md-inactive">done</i>  
                                </div>
                                {% endif %}

                                {% if post.status == 2 %}
                                <div class="" data-toggle="tooltip" data-html="true" data-placement='bottom' title="{% trans 'status_rejected_desc' %}">
                                    <i class="px-0 material-icons align-top md-inactive">clear</i>
                                </div>
                                {% endif %}

                                {% if post.status == 3 %}
                                <div class="" data-toggle="tooltip" data-html="true" data-placement='bottom' title="{% trans 'status_archived_desc' %}">
                                    <i class="px-0 material-icons align-top md-inactive">clear</i>!
                                </div>
                                {% endif %}

                            </td>


                            <td class="text-center">
                                <div class="pb-1"> 
                                    <a class="btn btn-sm btn-outline-info" href="{% url 'post_edit' post.slug %}" target="_blank"> 
                                         <i class="material-icons align-top">edit</i> 
                                    </a> 
                                </div>

                                <div class="pt-1"> 
                                    <a data-toggle="modal" data-target="#deletePostModal"> 
                                        <button type="button" class="btn btn-sm btn-outline-danger"> 
                                            <i class="material-icons align-top">delete</i> 
                                        </button> 
                                    </a> 
                                </div>
                            </td>
                        </tr>

                        <div class="modal fade" id="deletePostModal">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <span class="d-flex d-inline">
                                            <i style="font-size: 30px;" class="material-icons">error</i>
                                            <h4 class="ml-3 modal-title"> {% trans 'dashboard_PostDelete_Title' %}? </h4>
                                        </span>
                                        
                                        <button type="button" class="close" data-dismiss="modal">×</button>
                                    </div>
                                    
                                    <div class="modal-body">
                                        <form>
                                            <div class="container">
                                                <div class="row">
                                                    <div class="col-12 pt-2">
                                                        <div class="container"> 
                                                            <h6 class="ml-1"> {% trans 'dashboard_PostDelete' %} <b>{{post.title}}</b>? </h6>
                                                         </div> 
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <div class="modal-footer mr-2">
                                        <button type="button" class="btn border-secondary" data-dismiss="modal"> {% trans 'dashboard_DProblem_cancel' %} </button>
                                        <a href="{% url 'post_delete' post.slug %}" class="btn btn-danger"> {% trans 'dashboard_ConfirmDelete' %} </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        {% endfor %}

                          
                        <!-- Delete post Modal -->
                     
                        
                        
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


{% endblock %}
