{% extends 'LVR/user/base.html' %}
{% load static %}
{% load i18n %}
{% load crispy_forms_tags %} 

{% block post_edit %}

<div class="my-3 my-5 pt-4">

    <div class="card">
        <div class="card-body">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 text-left my-4">
                        <h3 class="section-heading font-weight-bold text-uppercase"> {% trans 'post_edit_Title' %} </h3>
                        <h4 class="section-subheading text-muted"> {% trans 'post_edit_Subtitle' %} :) </h4>
                    </div>
                </div>
                
                <div class="row py-5">
                    <div class="col-lg-12">
                        
                        <form id="newPost"  method="POST" enctype="multipart/form-data">
                            {% csrf_token %}    
                            
                            <!-- {{ form|crispy}} -->
                            
                            
                            <div class="row">
                                <div class="col-md-6">
                                    
                                    <div class="form-group py-1" > 
                                        <div class="container"> <div class="row"> <h6 class="ml-1"> Author </h6> </div> </div>   
                                        <div class="" data-toggle="tooltip" data-html="true" data-placement='right' title="{% for e in form.author.errors %} {% if form.author.errors|length == 1 %} <span> {{ e }} </span> {% else %} <li class='ml-1'>  {{ e }} </li> {% endif %} {% endfor %}">
                                            <input placeholder="{{ request.user.get_full_name}}" name="username" class="form-control" type="text" readonly disabled>
                                        </div>
                                    </div>
                                    
                                    <div class="form-group py-1">
                                        <div class="container"> <div class="row"> <h6 class="ml-1"> {{ form.title.label }} </h6> </div> </div>   
                                        <!-- <input type="text" class="form-control" name="title"> -->
                                        {{ form.title }}
                                    </div>
                                    
                                    <div class="form-group py-1">
                                        <div class="container"> <div class="row"> <h6 class="ml-1"> {{ form.subtitle.label }} </h6> </div> </div>   
                                        <!-- <input type="text" class="form-control" name="subtitle"> -->
                                        {{ form.subtitle }}

                                    </div>


                                    <!-- <div class="form-group col-lg-12">
                                        <label for="listingCategory">Listing category</label>
                                        <select class="selectpicker" id="listingCategory" name="listing-category" data-style="bs-select-form-control" data-title="Select listing category" data-width="100%" required>
                                          <option value="">Marketing</option>
                                          <option value="">Idea generation</option>
                                          <option value="">Idea generation</option>
                                          <option value="">Design</option>
                                          <option value="">Naming</option>
                                          <option value="">Domain names</option>
                                          <option value="">Sales</option>
                                          <option value="">Finance</option>
                                          <option value="">Project management</option>
                                          <option value="">Hosting</option>
                                          <option value="">Social tools</option>
                                        </select>
                                      </div>
                           -->

                                    
                                    <div class="form-group py-1" > 
                                        <div class="container"> <div class="row"> <h6 class="ml-1"> {{ form.image.label }} </h6> </div> </div>   
                                        <div class="img-upload"> 
                                            <div class="py-1" data-toggle="tooltip" data-html="true" data-placement='right' title="{% for e in form.image.errors %} {% if form.image.errors|length == 1 %} <span> {{ e }} </span> {% else %} <li class='ml-1'>  {{ e }} </li> {% endif %} {% endfor %}">
                                                {{ form.image }}  <!-- Username input -->
                                            </div>
                                        </div>
                                    </div>


                                    <div class="form-group py-1">
                                        <div class="container"> <div class="row"> <h6 class="ml-1"> {{ form.category.label }} </h6> </div> </div>   
                                        <!-- <input type="text" data-role="tagsinput" class="form-control" name="tags"> -->
                                        {{ form.category }}
                                        <p class="ml-1 mt-1 text-muted"> {{ form.category.help_text }} </p>

                                    </div>
                                    
                                    <div class="form-group py-1">
                                        <div class="container"> <div class="row"> <h6 class="ml-1"> {{ form.tags.label }} </h6> </div> </div>   
                                        <!-- <input type="text" data-role="tagsinput" class="form-control" name="tags"> -->
                                        {{ form.tags }}
                                        <p class="ml-1 mt-1 text-muted"> {{ form.tags.help_text }} </p>
                                    </div>
                                    
                                </div>

                            
                                
                                <div class="col-md-6"> 
                                    <div class="form-group py-1" > 
                                        <div class="container"> <div class="row"> <h6 class="ml-1"> {{ form.post_body.label }} </h6> </div> </div>   
                                        <div class="" data-toggle="tooltip" data-html="true" data-placement='right' title="{% for e in form.post_body.errors %} {% if form.subtitle.errors|length == 1 %} <span> {{ e }} </span> {% else %} <li class='ml-1'>  {{ e }} </li> {% endif %} {% endfor %}">
                                            <div>
                                            <!-- <div class="style="max-height: 475px; min-height: 350px"> -->
                                                <!-- <textarea name="post_body" class="form-control" style="max-height: 723px;" rows="17" type="text" placeholder=""></textarea> -->
                                                
                                                {{ form.post_body|safe }}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-lg-13 text-right">
                                        <a href="javascript:history.go(1)" class="btn btn-danger btn-xl text-uppercase my-3 mx-2"> <i class="material-icons align-top">cancel</i> {% trans 'Cancel' %} </a>
                                        <button type="submit" class="btn btn-primary btn-xl text-uppercase my-3"> <i class="material-icons align-top">save</i> {% trans 'Save' %} </button> 
                                    </div>
                                </div>
                                
                            </div>
                            
                            
                            {% for message in messages %}
                            <div id="toastMessage" class="toast fade show mr-2 mb-2" role="alert" aria-live="assertive" aria-atomic="true" data-autohide="false" data-delay="7000" style="position: fixed; bottom: 0; right:0;  z-index:1111;">
                                <div class="toast-header bg-info text-white">
                                    <svg class="bd-placeholder-img rounded mr-2" width="20" height="20" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" focusable="false" role="img"><rect width="100%" height="100%" fill="red"></rect></svg>
                                    <strong class="mr-auto">Error</strong>
                                    <!-- <small>11 mins ago</small> -->
                                    <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">×</span> </button>
                                </div>
                                <div class="toast-body"> {{ message }}
                                    <!-- El cuerpo del toast Intenta de nuevo.El cuerpo del toast Intenta de nuevo. El cuerpo del toast Intenta de nuevo.El cuerpo del toast Intenta de nuevo. El cuerpo del toast Intenta de nuevo.El cuerpo del toast Intenta de nuevo. -->
                                </div>
                            </div>
                            {% endfor %}
                            
                            
                        </form>
                        
                    </div>
                </div>            
            </div>
        </div>


        {% if is_edit %}

        <div>


            <div class="modal fade" id="deletePostModal">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <span class="d-flex d-inline">
                                <i style="font-size: 30px;" class="material-icons">error</i>
                                <h4 class="ml-3 modal-title"> {% trans 'dashboard_PostDelete_Title' %}? </h4>
                            </span>
                            
                            <button type="button" class="close" data-dismiss="modal">×</button>
                        </div>
                        
                        <div class="modal-body">
                            <form>
                                <div class="container">
                                    <div class="row">
                                        <div class="col-12 pt-2">
                                            <div class="container"> 
                                                <h6 class="ml-1"> {% trans 'dashboard_PostDelete' %} <b> {{ title }} </b>? </h6>
                                             </div> 
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        
                        <div class="modal-footer mr-2">
                            <button type="button" class="btn border-secondary" data-dismiss="modal"> {% trans 'dashboard_DProblem_cancel' %} </button>
                            <a href="{% url 'post_delete' slug %}" class="btn btn-danger"> {% trans 'dashboard_ConfirmDelete' %} </a>
                        </div>
                    </div>
                </div>
            </div>



            <div class="container d-flex inline">
                <h6 class="ml-2 font-weight-bold"> {% trans 'postStatus' %}: </h6>

                {% if status == 0 %}
                <div class="d-flex d-inline" data-toggle="tooltip" data-html="true" data-placement='top' title="{% trans 'status_draft_desc' %}">
                    <i class="ml-1 px-0 material-icons align-top md-inactive">access_time</i>  
                    <h6 > {% trans 'status_draft' %} </h6>
                </div>
                {% endif %}

                {% if status == 1 %}
                <div class="d-flex d-inline" data-toggle="tooltip" data-html="true" data-placement='top' title="{% trans 'status_approved_desc' %}">
                    <i class="ml-1 px-0 material-icons align-top md-inactive">done</i>  
                    <h6> {% trans 'status_approved' %} </h6>
                </div>
                {% endif %}

                {% if status == 2 %}
                <div class="d-flex d-inline" data-toggle="tooltip" data-html="true" data-placement='top' title="{% trans 'status_rejected_desc' %}">
                    <i class="ml-1 px-0 material-icons align-top md-inactive">clear</i>  
                    <h6> {% trans 'status_rejected' %} </h6>
                </div>
                {% endif %}

                {% if status == 3 %}

                <div class="d-flex d-inline" data-toggle="tooltip" data-html="true" data-placement='top' title="{% trans 'status_archived_desc' %}">
                    <i class="ml-1 px-0 material-icons align-top md-inactive">archive</i>  
                    <h6> {% trans 'status_archived' %} </h6>
                </div>


               
                {% endif %}




            </div>
            
            <hr>

            <div class="container mb-3">
                <div class="card border-danger rounded">
                    <div class="card-header p-0">
                        <div class="container py-2">
                            <h5 class="text-danger"> <i class="material-icons align-middle">warning</i> {% trans 'post_DangerZone' %} </h3>
                        </div>
                    </div>
                    <div class="card-body">
                        
                        <a type="button" class="mb-2 mb-sm-0 mb-md-0 mb-lg-0 mb-xl-0 btn btn-danger mr-2 text-white" data-toggle="modal" data-target="#deletePostModal"> 
                           {% trans 'post_deletePost' %}
                        </a>


                        {% if not status == 3 %}
                        <a type="button" class="btn btn-danger text-white" data-toggle="modal" data-target="#deletePostModal"> 
                            {% trans 'post_archivePost' %}
                         </a>
                        {% endif %}



                        

                       

                      
                    </div>
                </div>
            </div>
        </div>

        {% endif %}


    </div>
</div>


{% endblock %}